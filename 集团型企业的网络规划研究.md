### 集团型企业的网络规划研究
[摘 要] 描述了集团型企业信息化建设中网络规划的内容和方法。给出了集团型企业信息化网络规划的主要依据、目标和原则，以及实现的方法；重点介绍了网络安全控制的手段，并以实例对规划和设计的内容进行了详细说明。  

[关键词] 企业信息化建设；安全防护；网络体系  

### 一、	引言
信息化网络是现代化企业发展的关键保障，是企业信息化建设的重要环节，也是信息化工作开展的基础设施，承载了信息传递、数据交换、协同工作、对外联系等重要的业务支持和技术服务。  
企业信息化平台包含了基础办公系统、业务应用系统、数据库系统、商业智能决策支持系统、运维管理系统和业务测试系统等多种信息化系统。集团型企业在规划和建设集的信息化网络时，应根据信息化网络的多样性、复杂性、开放性等因素，同时兼顾子公司和分支机构的设立和管理需求，合理的对集团以及下属机构的信息化系统进行整合和统筹安排。  
网络技术在企业应用中的不断成熟和普及，一方面极大的促进了现代化企业运作效率的提高和运作成本的降低，一方面对信息化网络的安全保障的要求也在不断提高,需要引起管理者的高度重视。近年来，通过服务器操作系统和应用软件漏洞进行嗅探和攻击，成为计算机病毒和系统入侵的新型攻击手法。2017年NSA（National Security Agency，美国国家安全局）泄露了微软Windows操作系统漏洞“EternalBlue”（永恒之蓝），利用该漏洞进行传播的WannaCry勒索病毒，是其中的典型代表，该病毒传播至少150个国家，超过30万台计算机受到破坏，造成损失高达80亿美元， 影响涉及金融，能源，医疗等众多行业，造成严重的信息安全管理问题。同时，虚拟化（Virtualization）和容器（Docker）等新兴技术的深入应用，也对信息化网络的建设提出前所未有的挑战，过去数十年传统的网络控制手段，主要是基于物理设备进行管理和控制，而虚拟化环境中更多的是基于逻辑设备，因此，信息化网络在规划和设计的时候，也需要将虚拟化网络也纳入统一管理中来。  
本文在简要描述某集团公司网络现状的基础上，分析了该公司的业务架构和相关业务开展对于信息化网络提出的需求，从优化网络架构、加强安全控制的角度进行了调整。最后对具体说明了涉及的几种控制手段和实施建议。
### 二、	企业的网络体系现状和研究
某集团企业网络体系的总体情况
#### （一）	集团本部现状
该集团企业正式成立于2018年，由于成立时间较短，尚未对公司网络进行整体规划和部署，使用小型商用路由器接入互联网。集团和子公司之间的网络通信，通过互联网建立VPN隧道方式实现互联，稳定性较差，缺少基于QoS的优先级控制带宽限制，当局域网内出现高带宽占用的P2P下载、视频在线点播等应用时，会严重干扰正常的办公应用，如邮件通信、互联网访问等。集团的协同办公系统、财务系统、业务管理系统等应用系统，通过VMWare的虚拟化应用部署在不同的虚拟网络中，并通过软件防火墙对各个子网进行隔离。使用静态路由方式实现各网段之间的通信。
 
#### （二）	集团下属子公司网络体系
该集团企业下属包括货币兑换、私募基金、楼宇管理等在内的多家子公司，各子公司具有相互独立的办公网络，通过小型商用办公室用路由器接入互联网，访问互联网、邮件等资源，并共享局域网中的打印服务器等办公资源。对于网络数据通信，缺少带宽控制、访问控制和审计留痕等管理措施。其中货币兑换业务，由于涉及到特许经营业务，额外增加一条专线，连接至国家外汇管理局业务平台。网络拓扑如下：
 
#### （三）	信息安全风险
截止到2017年12月底，子公司电脑终端设备管理总体规模约150套左右，主要使用网络设备为TP-LINK、飞鱼星、华三等品牌设备。由于缺少专业的信息安全防护设备和策略，Windows Server、Oracle、MySQL等应用服务器和数据库服务器，业务端口和管理端口处于开放状态，包括Windows的3389远程桌面端口、Oracle的1521端口、SQL Server的1433端口，MySQL的3306端口，均直接暴露在内网。部分管理账号使用弱口令，存在极大的风险隐患。
对于网络环境中常见的攻击方式，如窃听、密码分析、盗窃登录密码、身份诈骗、抵赖、入侵、拒绝服务、恶意软件等， 难以做到有效的防御和管控。
### 三、网络体系结构的关键技术
#### （一）	网络的路由和交换
1．路由（routing）是指分组从源地址到目的地址时，决定端到端路径的网络范围的进程。路由工作在OSI参考模型第3层网络层，数据包转发的设备上。路由器通过转发数据包来实现网络互连。路由器可以支持多种协议（如TCP/IP、IPX/SPX、AppleTalk等协议），办公环境下主要使用TCP/IP协议。路由器可以连接两个或多个由IP子网或点到点协议所标识的逻辑网络端口，并具备至少1个物理端口。路由器根据收到数据包中的网络层地址以及路由器内部维护的路由表决定输出端口以及下一跳地址，并且重写链路层数据包头实现转发数据包。路由器通过动态维护路由表来反映当前的网络拓扑，并通过网络上其他路由器交换路由和链路信息来维护路由表。
路由动作包括两项基本内容：寻址和转发。寻址即判定到达目的地的最佳路径，由路由选择算法来实现。为了判定最佳路径，路由选择算法必须启动并维护包含路由信息的路由表，路由表中的路由信息依赖于所用的路由选择算法不同而不同。路由选择算法将收集到的不同信息填入路由表中，根据路由表可将目的网络与下一站（Nexthop）的关系告诉路由器。路由器间互通信息进行路由更新，更新维护路由表使之正确反映网络的拓扑变化，并由路由器根据度量来决定最佳路径。这就是路由选择协议，例如路由信息协议（RIP）、开放式最短路径优先协议（OSPF）和边界网关协议（BGP）等。   
2．交换（switching），从广义上讲，任何数据的转发都可以叫做交换。传统的、狭义的第2层交换技术，仅包括数据链路层的转发。2层交换机主要用在小型局域网中，终端设备数量在二、三十台以内，这样的网络环境下，广播包影响不大，2层交换机的快速交换功能、多个接入端口和低廉价格，为小型网络用户提供了完善的解决方案。第3层交换技术是1997年前后才开始出现的一种交换技术，最初是为了解决广播域的问题。经过多年发展，第3层交换技术已经成为构建多业务融合网络的主要力量。
#### （二）	VLAN和防火墙隔离技术
1．VLAN（虚拟局域网）主要用于实现将大型网络划分为多个小的网络，隔离原本在同一物理LAN中不同主机之间的二层通信。VLAN是对连接到的第二层交换机端口的网络用户进行逻辑分段，不受网络用户的物理位置限制而根据用户需求进行网络分段。一个VLAN可以在一个交换机或者跨交换机实现。VLAN可以根据网络用户的位置、作用、部门或者根据网络用户所使用的应用程序和协议来进行分组。基于交换机的虚拟局域网能够为局域网解决冲突域、广播域、带宽问题。  
2．防火墙技术，从本质上讲是一种保护装置，它保护的是数据、资源和用户的声誉。在企业中建立一个中介系统，竖起一道安全屏障，用以阻断来自不安全区域网络对特定保护区域网络的威胁和入侵。  最初是针对 Internet 网络不安全因素所采取的一种保护措施。用来阻挡外部不安全因素影响的内部网络屏障，其目的就是防止外部网络用户未经授权的访问。它是一种计算机硬件和软件的结合，使Internet与Internet之间建立起一个安全网关（Security Gateway），从而保护内部网免受非法用户的侵入，防火墙主要由服务访问政策、验证工具、包过滤和应用网关4个部分组成，防火墙就是一个位于计算机和它所连接的网络之间的软件或硬件。该计算机流入流出的所有网络通信均要经过此防火墙。  
#### （三）	ACL控制
ACL（Access Control List，访问控制列表）是一组报文过滤规则的集合，用于对匹配特定规则的报文进行允许通信或阻止通信的控制，ACL可以实现内网和外网用户的网络访问控制、路由信息过滤、QoS优先服务策略、IPSec报文加密过滤、策略路由等。ACL应用一般分为基本ACL、高级ACL、二层ACL和用户自定义ACL这四类ACL的配置与管理方法，其中基本ACL基于IP进行控制，高级ACL可同时基于IP和端口进行控制，二层ACL基于IP和报文的帧头信息如源地址的MAC地址信息进行控制，用户自定义ACL可以根据报文内容进行控制。不同品牌和型号的设备，对于未匹配规则的报文处理机制也不同，如华为品牌S系类交换机，未匹配规则的报文将被丢弃。
#### （四）	VPN技术
VPN（Virtual Private Network）是指在公用网络上建立一个私有的、专用的虚拟通信网络，并对通信内容进行加密。VPN技术广泛应用于企业网络中分支机构和出差员工连接公司总部网络的场景。 VPN网关通过对数据包的加密和数据包目标地址的转换实现远程访问。VPN有多种分类方式，根据建设单位可分为租用运营商VPN专线搭建的企业VPN网络、用户自建企业VPN网络；根据组网方式可分为远程访问VPN（Access VPN）、局域网到局域网的VPN（sit-to-site VPN），本文中某集团的子公司到集团公司网络接入，即采用局域网到局域网VPN组网。
根据VPN技术实现的网络层次，分为如下：  
1.基于数据链路层：L2TP、LF、PPTP；  
2.基于网络层：GRE、IPSec、DSVPN；  
3.基于应用层：SSLVPN  
VPN可通过服务器、硬件、软件等多种方式实现。VPN为企业构建安全、稳定的网络互联提供了成本相对低廉的解决方案。
#### （五）	QoS质量服务
QoS（Quality of Service，服务质量）是一种可以为不同类型业务流提供差异化服务等级的技术。 通过QoS可以给那些对贷款、时延、时延抖动、丢包率等敏感的业务流提供更加优先的服务等级，是的这些业务能满足用户正常、高性能的需求。QoS包括三种服务模型，分别是Best Effort模型、IntServ模型、DiffServ模型，其中Best Effort模型相对简单，为所有业务流提供相同服务等级；IntServ模型常与组播应用结合，用于需要保证带宽、低延迟的实时多媒体应用；DiffServ模型是多服务模型针对不同的业务提供差异化的服务。
### 四、网络体系的规划设计
#### （一）	集团型企业的网络体系需求分析
集团型企业的网络体系将要承载集团公司和子公司之间的协同办公、数据共享、信息交流等重要功能。信息化网络不仅要有效保障业务正常开展，面对可能发生的远程攻击、内网病毒感染等问题，还应提供有效的防护手段。为此，在规划设计的时候，着重实现以下几方面的要求：  
1．满足良好的扩展性要求  
网络体系基于TCP/IP协议进行设计，应具备一定的前瞻性，可配合业务发展，对网络规模和带宽进行扩展，避免互联障碍。  
2．满足信息化安全需求  
对访问进行控制，将办公区域划分为DMZ区域、办公区域、办公服务器区域、应用服务器区域、数据库服务器区域、运维管理区域，进行区域隔离。  
对于区域之间，设置访问控制策略，限制非正常的数据访问，确保服务器区域有效与互联网区域隔离，并阻止未经授权的访问。  
结合业务特性，将信息安全对策按照抑制、预防、防御、检测、恢复五大类。 在抑制和预防两个层面，通过访问控制策略进行安全加固。  
3．满足可靠性和稳定性需求  
公司对外提供金融服务业务，网络体系需要在遇到突发状况时，能保证各项业务系统持续、稳定的继续工作，并在尽可能端的时间内恢复正常。  
4．满足IT成本控制的需求  
网络建设的IT费用投入，应配合公司的业务发展需要和费用投入能力，循序渐进的进行，在把握质量的同时，还需要定期通过标杆分析（benchmarking）进行成本合理性的评估。  
#### （二）	拓扑结构设计
网络拓扑选择星型拓扑结构，中心节点可控制分支节点之间的通信，便于集中控制和扩展，当网络规模和复杂程度进一步增加时，可以通过构造双核心冗余设计，实现高可用和横向扩展。      
 
#### （三）	网络路由设计
1．路由策略优化  
路由选择协议包括RIP、OSFP、EIGRP等几种，对于规模较小的网络环境，也可使用静态路由(Static routing)进行管理，静态路由在网络扩展时，需要以手工方式进行维护，配合网络拓扑结构的变化，添加或更新路由条目。对于规模较大、拓扑较为复杂的网络中，则应将动态路由（Dynamic routing）作为首选，通过路由表的自动更新和最优路径的自动选择，降低维护成本和差错率。  
2．子网规划设计  
对于企业环境下的百兆办公网络和千兆或万兆核心网络，当网络规模过大，或出节点异常通信时，容易引起广播风暴，造成整个网络抖动甚至瘫痪。划分子网，应合理的缩小广播域，以提高通信质量和通信效率，有效对网络地址进行管理，便于在出现异常时，快速定位故障点，及时排查和解决。  
根据集团型企业网络体系的管理和应用需求，子网可划分成设备管理段、办公服务器段、应用服务器段、运维管理段、数据库服务器段、DMZ段，以及集团和各子公司用户网段，各网段统一使用C类地址，子网掩码255.255.255.0，具体如下：  
```shell
功能	所属子公司	网段	网关地址
设备管理段	集团公司	10.199.10.0/24	10.199.10.254
办公服务器段		10.166.10.0/24	10.166.10.254
应用服务器段		10.166.20.0/24	10.166.20.254
运维管理段		10.166.30.0/24	10.166.30.254
数据库服务器段		10.166.100.0/24	10.166.100.254
DMZ段		172.66.10.0/24	17.66.10.254
用户办公段		10.188.10.0/24	10.188.10.254
用户办公段（无线）		10.177.10.0/24	10.177.10.254
各子公司网段	子公司一	10.188.110.0/24	10.188.110.254
	子公司二	10.188.120.0/24	10.188.120.254
	子公司三	10.188.130.0/24	10.188.130.254
```
3．地址规划设计  
地址规划是网络设计中的重要部分，规划时应设立地址分配标准、合理利用资源、分类进行控制，使得地址已于记忆、扩展，出现故障如网络流量异常时，能通过检测到的IP地址，快速判断出相关信息。  
对于管理和服务器地址，特别是结合Windows活动目录（Active Directory）、Oracle的RAC（Oracle Real Application Cluster）， 等依赖IP地址的业务应用，应使用静态IP地址。对于流动性较高、地址资源占用较多的用户网络，应使用动态IP地址，当地址不再使用时，能自动释放IP资源，供其他用户使用。  
#### （四）	安全控制和隔离策略
1.	交换设备的ACL控制策略设计  
在设计ACL控制策略时，应提前对应用的业务端口、源地址和目的地址进行整理，作为命令配置的依据，例如某集团的VLAN101段，需允许VLAN301网段的监控服务器对段内设备的10050端口进行访问，以及堡垒机对段内服务器设备的3389、22管理端口进行访问，整理结果如下：  
```shell
ACL名称	源区域	源地址	目的区域	目的地址	ACL端口	动作
Zabbix监控	VLAN301	10.199.10.55	VLAN101	any	10050	允许
堡垒机管理	VLAN103	10.166.30.21/24	VLAN101	10.166.10.0/24	3389	允许
堡垒机管理	VLAN103	10.166.30.21/24	VLAN101	10.166.10.0/24	22	允许
```
设备配置信息如下：  
```shell
acl number 3601
 rule 0 permit tcp established
 rule 1 permit tcp destination 10.199.10.55 0 destination-port eq 10050
 rule 5 permit tcp source 10.166.30.21 0 destination 10.166.10.0 0.0.0.255 destination-port eq 3389
 rule 10 permit tcp source 10.166.30.21 0 destination 10.166.10.0 0.0.0.255 destination-port eq 22
rule 50 deny tcp
```
配置完成的ACL，应用于VLAN的正确方向生效：  
```shell
sys
interface Vlan-interface 101
packet-filter 3602 onbound
display vlan101
interface Vlan-interface101
 description server_yewu
 ip address 10.166.10.254 255.255.255.0
 packet-filter 3602 outbound
```
变更完成后，应及时保存配置，以免设备重启或掉电后，配置信息丢失。  
2.	防火墙访问控制策略设计  
防火墙控制策略，优先顺序为从上到下，默认为禁止访问，具体如下设置：  
（1）服务器允许访问策略  
应用服务器，根据实际业务，开放用户段到业务端口的访问，如用户网络到运维服务器的HTTP端口（端口号80）的访问：  
 
（2）服务器禁止访问策略  
所有端口安全策略，以禁止访问作为最后一条策略：  
 
(3）Windows类服务器的安全策略  
由于Windows类操作系统用户数量庞大、系统复杂，出现漏洞的情况也较为普遍，且影响范围较大，针对远程桌面口令暴力破解方式的攻击，设置防火墙策略，禁用远程桌面（MS RDP 3389）的访问：  
 
##### （五）	网络运行监控
1.	设备运行状态的监控  
监控系统用于对物理硬件和应用软件的性能和参数进行数据汇集，实现集中管理和统一分析添加监控理论内容。 现代企业信息化设备繁多，依赖人工监测和管理，难以做到完整、高效、准确的进行控制，也无法准确的对系统运行状态进行判断和故障处理，借助监控系统，能结合历史数据，及时的发现问题、客观的分析问题，有效的解决问题。  
对网络设备的监控，可以通过设备的SNMP服务，获取设备温度传感器数据、供电状态等物理硬件设备信息，以及端口流入和流出的数据量这一关键运行状态信息。  
 
2.	网络运行状态的监控  
采用SNMP服务对设备进行监控时，需要在设备上配置并开启正确版本的SNMP协议，以及团体名(Community Name)用于通信，例如：  
```shell
snmp-agent
snmp-agent local-engineid 800063A280441AFAF6E9C900000001
snmp-agent sys-info version v2c v3 
snmp-agent target-host trap address udp-domain 10.199.10.55 udp-port 5000 params securityname och_public
```
同时在监控系统中，根据IP地址，添加相应的设备，例如：  
 
最后，通过可视化的图表，将设备运行情况通过便于理解和判断的方式呈现出来  
 
### 结语
本文探讨和研究了集团型企业网络体系在建设过程中，需要重点关注的若干问题，尤其是在新技术不断涌现的环境下，如何合理的规划设计安全可靠、易于扩展的网络体系，同时也结合了作者在多次参与信息化网络建设过程中的实践和总结，以期对企业网络体系的规划和建设提供参考。  
需要注意的是，不同的企业所关注的核心业务和系统建设投入能力大相径庭，加之网络技术的发展和应用水平日新月异，以及作者理论水平的欠缺，错误和不完善在所难免，恳请各位专家和老师批评指正。  

### 参考文献  
[1] 黄子河. 2017 – 2018 年中国网络安全发展蓝皮书[M]. 人民出版社, 2018.  
[2] 王杰. 计算机网络安全的理论与实践[M]. 高等教育出版社, 2017.  
[3] 徐慧洋, 白杰, 卢宏旺. 华为防火墙技术漫谈[M]. 人民邮电出版社, 2015.  
[4] 王达. 华为交换机学习指南[M]. 人民邮电出版社, 2014.  
[5] 野村综合研究所系统咨询事业本部. 图解CIO工作指南[M]. 人民邮电出版社, 2014.  
[6] 吴兆松. Zabbix企业级分布式监控系统[M]. 电子工业出版社, 2014.  
